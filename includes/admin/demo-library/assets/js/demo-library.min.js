!function($){"use strict";var $body=$("body"),$document=$(document),$html=($("#page"),$("html")),PrismaCompanionDemoLibrary={import_start_time:"",install_plugins:[],installed_plugins:[],progress:0,import_steps:[],completed_steps:[],init:function(){$(document).ready(PrismaCompanionDemoLibrary.ready),$(window).on("load",PrismaCompanionDemoLibrary.load),PrismaCompanionDemoLibrary.bindUIActions(),$(document).trigger("prismaCompanionReady")},ready:function(){},load:function(){PrismaCompanionDemoLibrary.populateTemplates(prismaCompanionDemoLibrary.templates)},bindUIActions:function(){$document.on("click",".prisma-companion-demo .demo-screenshot, .prisma-companion-demo .preview",PrismaCompanionDemoLibrary.preview),$document.on("click",".prisma-companion-demo .import",function(e){$(this).siblings(".preview").click(),$(".wp-full-overlay-main iframe").on("load",function(){$(".wp-full-overlay-header .prisma-companion-demo-import").trigger("click")})}),$document.on("click",".close-full-overlay",PrismaCompanionDemoLibrary.closePreview),$document.keyup(function(e){27===e.keyCode&&$(".close-full-overlay").trigger("click")}),$document.on("click",".next-theme",PrismaCompanionDemoLibrary.previewNext),$document.on("click",".previous-theme",PrismaCompanionDemoLibrary.previewPrevious),$document.on("click",".devices button",PrismaCompanionDemoLibrary.previewDevice),$document.on("click",".collapse-sidebar",PrismaCompanionDemoLibrary.collapseSidebar),$document.on("click",".pc-demo-section-title .control-toggle label",PrismaCompanionDemoLibrary.collapsePreviewSection),$document.on("click",".prisma-companion-demo-import",PrismaCompanionDemoLibrary.importDemo),$document.on("click","#import_content, #import_media",PrismaCompanionDemoLibrary.importOptionsContent),$document.on("prisma-companion-import_started",PrismaCompanionDemoLibrary.importStarted),$document.on("prisma-companion-install_plugins",PrismaCompanionDemoLibrary.pluginsInstallActivate),$document.on("prisma-companion-import_customizer",PrismaCompanionDemoLibrary.importCustomizer),$document.on("prisma-companion-import_content",PrismaCompanionDemoLibrary.importContent),$document.on("prisma-companion-import_widgets",PrismaCompanionDemoLibrary.importWidgets),$document.on("prisma-companion-import_options",PrismaCompanionDemoLibrary.importOptions),$document.on("prisma-companion-import_wpforms",PrismaCompanionDemoLibrary.importWPForms),$document.on("prisma-companion-import_completed",PrismaCompanionDemoLibrary.importCompleted),$document.on("click",".demo-filters a",PrismaCompanionDemoLibrary.filters),$document.on("input",".demo-search input",PrismaCompanionDemoLibrary.search)},preview:function(event){event.preventDefault();$(this).parents(".prisma-companion-demo").data("demo-id");var self=$(this).parents(".prisma-companion-demo");self.addClass("prisma-companion-demo-previewed"),$html.addClass("prisma-companion-demo-preview-on"),PrismaCompanionDemoLibrary.previewDemo(self)},previewDemo:function(anchor){var template=wp.template("prisma-companion-demo-preview"),data={id:anchor.data("demo-id"),pro:anchor.data("demo-pro"),url:anchor.data("demo-url"),screenshot:anchor.data("demo-screenshot"),name:anchor.data("demo-name"),description:anchor.data("demo-description"),slug:anchor.data("demo-slug"),required_plugins:anchor.data("required-plugins")};$(".theme-install-overlay").remove(),$(".prisma-core-section.demos").append(template(data)),$(".theme-install-overlay").css("display","block"),PrismaCompanionDemoLibrary.updateNextPrev(),$(".wp-full-overlay-main iframe").on("load",function(){$(".prisma-companion-demo-preview .prisma-companion-demo-import").removeAttr("disabled")})},updateNextPrev:function(){if($body.hasClass("importing"))$(".next-theme, .previous-theme").addClass("disabled");else{var current=$(".prisma-companion-demo-previewed").parent(),next=current.nextAll(".prisma-core-column").length,prev=current.prevAll(".prisma-core-column").length;0==next?$(".next-theme").addClass("disabled"):0!=next&&$(".next-theme").removeClass("disabled"),0==prev?$(".previous-theme").addClass("disabled"):0!=prev&&$(".previous-theme").removeClass("disabled")}},closePreview:function(event){event.preventDefault(),$("body").hasClass("importing")&&!confirm(prismaCompanionDemoLibrary.strings.closeWindowWarning)||($("body").removeClass("importing"),$(".previous-theme, .next-theme").removeClass("disabled"),$(".theme-install-overlay").css("display","none"),$(".theme-install-overlay").remove(),$(".prisma-companion-demo-previewed").removeClass("prisma-companion-demo-previewed"),$html.removeClass("prisma-companion-demo-preview-on"))},previewPrevious:function(event){event.preventDefault();var prev=$(".prisma-companion-demo-previewed").removeClass("prisma-companion-demo-previewed").parent().prev(".prisma-core-column").find(".prisma-companion-demo").addClass("prisma-companion-demo-previewed");$(this).parents(".wp-full-overlay-header").data("demo-id");PrismaCompanionDemoLibrary.previewDemo(prev)},previewNext:function(event){event.preventDefault();var next=$(".prisma-companion-demo-previewed").removeClass("prisma-companion-demo-previewed").parent().next(".prisma-core-column").find(".prisma-companion-demo").addClass("prisma-companion-demo-previewed");$(this).parents(".wp-full-overlay-header").data("demo-id");PrismaCompanionDemoLibrary.previewDemo(next)},previewDevice:function(event){var device=$(event.currentTarget).data("device");$(".theme-install-overlay").removeClass("preview-desktop preview-tablet preview-mobile").addClass("preview-"+device).data("current-preview-device",device),PrismaCompanionDemoLibrary.previewDeviceButtons(device)},previewDeviceButtons:function(device){var $devices=$(".wp-full-overlay-footer .devices");$devices.find("button").removeClass("active").attr("aria-pressed",!1),$devices.find("button.preview-"+device).addClass("active").attr("aria-pressed",!0)},collapseSidebar:function(){event.preventDefault();var overlay=$(".wp-full-overlay");return overlay.hasClass("expanded")?(overlay.removeClass("expanded"),void overlay.addClass("collapsed")):overlay.hasClass("collapsed")?(overlay.removeClass("collapsed"),void overlay.addClass("expanded")):void 0},collapsePreviewSection:function(){var section_content=$(this).closest(".pc-demo-section-title").next(".pc-demo-section-content");$(this).prev('input[type="checkbox"]').is(":checked")?section_content.removeClass("hidden"):section_content.addClass("hidden")},importDemo:function(event){if(event.preventDefault(),!$("body").hasClass("importing")&&confirm(prismaCompanionDemoLibrary.strings.importDemoWarning)){new Date;PrismaCompanionDemoLibrary.import_start_time=new Date,void 0!==$(this).attr("disabled")&&$(this).hasClass("disabled")||(PrismaCompanionDemoLibrary.install_plugins=$(".plugin-list input:checked").not(":disabled").map(function(){return{slug:$(this).data("slug"),name:$(this).next(".pc-label").html(),status:$(this).data("status")}}).get(),PrismaCompanionDemoLibrary.import_steps=$(".pc-demo-section-content.import-options input:checked").map(function(){if("import_media"!==$(this).attr("id"))return $(this).attr("id")}).get(),PrismaCompanionDemoLibrary.install_plugins.length&&PrismaCompanionDemoLibrary.import_steps.unshift("install_plugins"),PrismaCompanionDemoLibrary.import_steps.includes("import_content")&&($("#install_plugin_wpforms-lite").is(":checked")&&PrismaCompanionDemoLibrary.import_steps.splice(PrismaCompanionDemoLibrary.import_steps.indexOf("import_content"),0,"import_wpforms"),PrismaCompanionDemoLibrary.import_steps.push("import_options")),PrismaCompanionDemoLibrary.import_steps.unshift("import_started"),PrismaCompanionDemoLibrary.import_steps.push("import_completed"),$body.addClass("importing"),PrismaCompanionDemoLibrary.updateNextPrev(),$(".pc-checkbox input").attr("disabled","disabled"),$(".wp-full-overlay-header .prisma-companion-demo-import").text(prismaCompanionDemoLibrary.strings.importing),$document.trigger("prisma-companion-"+PrismaCompanionDemoLibrary.import_steps[0]))}},pluginsInstallActivate:function(){PrismaCompanionDemoLibrary.progress_delta=50/PrismaCompanionDemoLibrary.import_steps.length/PrismaCompanionDemoLibrary.install_plugins.length,PrismaCompanionDemoLibrary.pluginInstall(PrismaCompanionDemoLibrary.install_plugins[0])},pluginInstall:function(plugin){if($(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.installingPlugin+plugin.name),wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked&&(wp.updates.requestFilesystemCredentials(event),$(document).on("credential-modal-cancel",function(){wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})),"not_installed"===plugin.status)wp.updates.installPlugin({slug:plugin.slug,success:function(){PrismaCompanionDemoLibrary.updateProgressBar(),$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.installed),PrismaCompanionDemoLibrary.pluginActivate(plugin)},error:function(response){console.log(response)}});else if("installed"===plugin.status)PrismaCompanionDemoLibrary.updateProgressBar(),$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.installed),PrismaCompanionDemoLibrary.pluginActivate(plugin);else{if(PrismaCompanionDemoLibrary.updateProgressBar(),$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.activated),PrismaCompanionDemoLibrary.installed_plugins.push(PrismaCompanionDemoLibrary.install_plugins.shift()),PrismaCompanionDemoLibrary.install_plugins.length)return PrismaCompanionDemoLibrary.pluginInstall(PrismaCompanionDemoLibrary.install_plugins[0]);PrismaCompanionDemoLibrary.importNextStep()}},pluginActivate:function(plugin){return $(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.activatingPlugin+plugin.name),$.ajax({url:prisma_companion_strings.ajaxurl,type:"POST",dataType:"json",data:{_ajax_nonce:prisma_companion_strings.wpnonce,action:"prisma_companion_import_step",import_step:"activate_plugin",plugin:plugin,demo_id:$(".wp-full-overlay-header").data("demo-slug")}}).then(function(data){if(PrismaCompanionDemoLibrary.updateProgressBar(),$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.activated),PrismaCompanionDemoLibrary.installed_plugins.push(PrismaCompanionDemoLibrary.install_plugins.shift()),PrismaCompanionDemoLibrary.install_plugins.length)return PrismaCompanionDemoLibrary.pluginInstall(PrismaCompanionDemoLibrary.install_plugins[0]);PrismaCompanionDemoLibrary.importNextStep()})},importStepAJAX:function(data){return data._ajax_nonce=prisma_companion_strings.wpnonce,data.action="prisma_companion_import_step",data.demo_id=$(".wp-full-overlay-header").data("demo-slug"),$.ajax({url:prisma_companion_strings.ajaxurl,type:"POST",dataType:"json",data:data}).done(function(response){response.success?(PrismaCompanionDemoLibrary.updateProgressBar(),PrismaCompanionDemoLibrary.importNextStep()):console.log(response)}).fail(function(jqXHR,textStatus,errorThrown){console.log(jqXHR),console.log(textStatus),console.log(errorThrown)})},importStarted:function(){return PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_started"})},importCustomizer:function(){$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importingCustomizer);return PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_customizer"})},importContent:function(){$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importingContent);var data={import_step:"import_content",attachments:$("#import_media").is(":checked")?1:0};return PrismaCompanionDemoLibrary.importStepAJAX(data)},importOptions:function(){$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importingOptions);return PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_options"})},importWPForms:function(){$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importingWPForms);return PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_wpforms"})},importWidgets:function(){$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importingWidgets);return PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_widgets"})},importCompleted:function(){PrismaCompanionDemoLibrary.importStepAJAX({import_step:"import_completed"}),$(".wp-full-overlay-header .prisma-companion-demo-import").html(prismaCompanionDemoLibrary.strings.preview),$(".prisma-companion-demo-preview .prisma-companion-demo-import").removeClass("prisma-companion-demo-import").attr("href",prismaCompanionDemoLibrary.homeurl),$(".wp-full-overlay-footer .status").text(prismaCompanionDemoLibrary.strings.importCompleted),$body.removeClass("importing"),setTimeout(function(){$(".wp-full-overlay-footer .pc-btn").addClass("animate")},100),setTimeout(function(){$(".wp-full-overlay-footer .pc-btn").removeClass("animate")},3e3),PrismaCompanionDemoLibrary.updateNextPrev()},importNextStep:function(){PrismaCompanionDemoLibrary.import_steps.length?(PrismaCompanionDemoLibrary.completed_steps.push(PrismaCompanionDemoLibrary.import_steps.shift()),PrismaCompanionDemoLibrary.updateProgressBar(),$document.trigger("prisma-companion-"+PrismaCompanionDemoLibrary.import_steps[0])):$document.trigger("prisma-companion-import_completed")},updateProgressBar:function(){var delta=(100-PrismaCompanionDemoLibrary.progress)/PrismaCompanionDemoLibrary.import_steps.length;0<PrismaCompanionDemoLibrary.install_plugins.length&&(delta/=2,delta/=PrismaCompanionDemoLibrary.install_plugins.length),PrismaCompanionDemoLibrary.progress+=delta,$("#pc-progress-bar .pc-progress-percentage").css("width",PrismaCompanionDemoLibrary.progress+"%")},importOptionsContent:function(){var $checkbox=$(this);"import_content"===$checkbox.attr("id")&&($checkbox.is(":checked")?$("#import_media").removeAttr("disabled","disabled"):$("#import_media").attr("disabled","disabled").removeAttr("checked")),"import_media"===$checkbox.attr("id")&&$checkbox.is(":checked")&&$("#import_content").attr("checked","checked")},populateTemplates:function(templates){if($(".prisma-core-section.demos").html(""),_.isEmpty(templates))$(".prisma-core-section.demos").html('<div class="prisma-core-column">'+prismaCompanionDemoLibrary.strings.noResultsFound+"</div>");else{var data,demo_template=wp.template("prisma-companion-demo-item");for(var key in templates)data={id:key,pro:templates[key].pro,url:templates[key].url,screenshot:templates[key].screenshot,name:templates[key].name,description:templates[key].description,slug:templates[key].slug,required_plugins:templates[key].plugins},$(".prisma-core-section.demos").append(demo_template(data))}},filters:function(e){e.preventDefault();var $this=$(this);$this.closest("ul").find("li").removeClass("selected"),$this.closest("li").addClass("selected"),PrismaCompanionDemoLibrary.filterDemoList()},search:function(){var $this=$(this),timer=0;timer&&clearTimeout(timer);var search_input=$this.val();(!search_input||search_input&&4<=search_input.length)&&(timer=setTimeout(function(){PrismaCompanionDemoLibrary.filterDemoList()},300))},filterDemoList:function(){var filters={category:$(".demo-filters .demo-categories li.selected a").data("category"),builder:$(".demo-filters .demo-builders li.selected a").data("builder"),s:$(".demo-search input").val()};return $.ajax({url:prisma_companion_strings.ajaxurl,type:"POST",dataType:"json",data:{_ajax_nonce:prisma_companion_strings.wpnonce,action:"prisma-companion-filter-demos",filters:filters}}).then(function(response){response.success&&PrismaCompanionDemoLibrary.populateTemplates(response.data)})}};PrismaCompanionDemoLibrary.init(),window.PrismaCompanionDemoLibrary=PrismaCompanionDemoLibrary}(jQuery);