!function($){"use strict";$("body"),$(document),$("#page"),$("html");var PrismaCompanionWidgets={init:function(){$(document).ready(PrismaCompanionWidgets.ready),$(window).on("load",PrismaCompanionWidgets.load),PrismaCompanionWidgets.bindUIActions(),$(document).trigger("prismaCompanionWidgetsReady")},ready:function(){PrismaCompanionWidgets.initRepeatableSortable()},load:function(){},bindUIActions:function(){var $this,template,$widget,index=0;$(document).on("click",".pc-repeatable-widget .add-new-item",function(e){e.preventDefault(),$this=$(this),index=parseInt($this.attr("data-index")),template=wp.template("prisma-companion-repeatable-item");var data={index:index,name:$this.attr("data-widget-name"),id:$this.attr("data-widget-id")};index++,$this.attr("data-index",index),$(template(data)).insertBefore($this.closest(".pc-repeatable-footer")),$this.closest(".widget-inside").trigger("change"),update_widget_repeatable_class($this)}),$(document).on("click",".pc-repeatable-widget .remove-repeatable-item",function(e){e.preventDefault(),$this=$(this),$widget=$this.closest(".pc-repeatable-container"),$this.closest(".widget-inside").trigger("change"),$this.closest(".pc-repeatable-item").remove(),update_widget_repeatable_class($widget)}),$(document).on("click",".pc-repeatable-widget .pc-repeatable-item-title",function(){$(this).closest(".pc-repeatable-item").toggleClass("open")});var update_widget_repeatable_class=function($target){var $widget=$target.closest(".pc-repeatable-container");$widget.find(".pc-repeatable-item").length?$widget.removeClass("empty"):$widget.addClass("empty")};$(document).on("widget-updated widget-added",function(e,widget){widget.find(".pc-repeatable-container").length&&PrismaCompanionWidgets.initRepeatableSortable()})},initRepeatableSortable:function(){$(".pc-repeatable-container").sortable({handle:".pc-repeatable-item-title",accent:".pc-repeatable-item",containment:"parent",tolerance:"pointer",change:function(event,ui){$(this).closest(".widget-inside").trigger("change")}})}};PrismaCompanionWidgets.init(),window.PrismaCompanionWidgets=PrismaCompanionWidgets}(jQuery);